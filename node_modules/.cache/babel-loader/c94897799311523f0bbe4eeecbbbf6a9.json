{"ast":null,"code":"import { register as registerServiceWorker } from \"../serviceWorker\";\nimport { EVENT } from \"../constants\"; // On Apple mobile devices add the proprietary app icon and splashscreen markup.\n// No one should have to do this manually, and eventually this annoyance will\n// go away once https://bugs.webkit.org/show_bug.cgi?id=183937 is fixed.\n\nif (/\\b(iPad|iPhone|iPod|Safari)\\b/.test(navigator.userAgent) && !matchMedia(\"(display-mode: standalone)\").matches) {\n  import(\n  /* webpackChunkName: \"pwacompat\" */\n  \"pwacompat\");\n}\n\nregisterServiceWorker({\n  onUpdate: registration => {\n    const waitingServiceWorker = registration.waiting;\n\n    if (waitingServiceWorker) {\n      waitingServiceWorker.addEventListener(EVENT.STATE_CHANGE, event => {\n        const target = event.target;\n        const state = target.state;\n\n        if (state === \"activated\") {\n          window.location.reload();\n        }\n      });\n      waitingServiceWorker.postMessage({\n        type: \"SKIP_WAITING\"\n      });\n    }\n  }\n});","map":{"version":3,"sources":["/var/www/html/excalidraw/src/excalidraw-app/pwa.ts"],"names":["register","registerServiceWorker","EVENT","test","navigator","userAgent","matchMedia","matches","onUpdate","registration","waitingServiceWorker","waiting","addEventListener","STATE_CHANGE","event","target","state","window","location","reload","postMessage","type"],"mappings":"AAAA,SAASA,QAAQ,IAAIC,qBAArB,QAAkD,kBAAlD;AACA,SAASC,KAAT,QAAsB,cAAtB,C,CAEA;AACA;AACA;;AACA,IACE,gCAAgCC,IAAhC,CAAqCC,SAAS,CAACC,SAA/C,KACA,CAACC,UAAU,CAAC,4BAAD,CAAV,CAAyCC,OAF5C,EAGE;AACA;AAAO;AAAoC,aAA3C;AACD;;AAEDN,qBAAqB,CAAC;AACpBO,EAAAA,QAAQ,EAAGC,YAAD,IAAkB;AAC1B,UAAMC,oBAAoB,GAAGD,YAAY,CAACE,OAA1C;;AACA,QAAID,oBAAJ,EAA0B;AACxBA,MAAAA,oBAAoB,CAACE,gBAArB,CACEV,KAAK,CAACW,YADR,EAEGC,KAAD,IAAkB;AAChB,cAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;AACA,cAAMC,KAAK,GAAGD,MAAM,CAACC,KAArB;;AACA,YAAIA,KAAK,KAAK,WAAd,EAA2B;AACzBC,UAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD;AACF,OARH;AAUAT,MAAAA,oBAAoB,CAACU,WAArB,CAAiC;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAAjC;AACD;AACF;AAhBmB,CAAD,CAArB","sourcesContent":["import { register as registerServiceWorker } from \"../serviceWorker\";\nimport { EVENT } from \"../constants\";\n\n// On Apple mobile devices add the proprietary app icon and splashscreen markup.\n// No one should have to do this manually, and eventually this annoyance will\n// go away once https://bugs.webkit.org/show_bug.cgi?id=183937 is fixed.\nif (\n  /\\b(iPad|iPhone|iPod|Safari)\\b/.test(navigator.userAgent) &&\n  !matchMedia(\"(display-mode: standalone)\").matches\n) {\n  import(/* webpackChunkName: \"pwacompat\" */ \"pwacompat\");\n}\n\nregisterServiceWorker({\n  onUpdate: (registration) => {\n    const waitingServiceWorker = registration.waiting;\n    if (waitingServiceWorker) {\n      waitingServiceWorker.addEventListener(\n        EVENT.STATE_CHANGE,\n        (event: Event) => {\n          const target = event.target as ServiceWorker;\n          const state = target.state as ServiceWorkerState;\n          if (state === \"activated\") {\n            window.location.reload();\n          }\n        },\n      );\n      waitingServiceWorker.postMessage({ type: \"SKIP_WAITING\" });\n    }\n  },\n});\n"]},"metadata":{},"sourceType":"module"}